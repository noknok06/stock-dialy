{% load stockdiary_filters %}
{% load humanize %}

{% with display_style=style|default:"inline" decimal_places=decimals|default:0 show_sign=always_show_sign|default:True %}

{% if profit is not None %}
  {% if display_style == "badge" %}
    <span class="badge {% if profit > 0 %}bg-success{% elif profit < 0 %}bg-danger{% else %}bg-secondary{% endif %} {% if size %}badge-{{ size }}{% endif %}">
      {% if show_icon %}
        {% if profit > 0 %}<i class="bi bi-graph-up-arrow me-1"></i>
        {% elif profit < 0 %}<i class="bi bi-graph-down-arrow me-1"></i>
        {% endif %}
      {% endif %}
      {% if profit > 0 and show_sign %}+{% endif %}{{ profit|intcomma_float:decimal_places }}円
    </span>
    
  {% elif display_style == "card" %}
    <div class="profit-card {% if profit > 0 %}profit{% elif profit < 0 %}loss{% endif %} {% if size %}profit-{{ size }}{% endif %}">
      {% if label %}
      <div class="profit-label">{{ label }}</div>
      {% endif %}
      <div class="profit-value">
        {% if profit > 0 and show_sign %}+{% endif %}{{ profit|intcomma_float:decimal_places }}<span class="profit-unit">円</span>
      </div>
    </div>
    
  {% else %}
    {# inline style #}
    {% if label %}<span class="text-muted">{{ label }}: </span>{% endif %}
    <span class="{% if profit > 0 %}text-success{% elif profit < 0 %}text-danger{% endif %} {% if size %}profit-{{ size }}{% endif %}">
      {% if show_icon %}
        {% if profit > 0 %}<i class="bi bi-graph-up-arrow me-1"></i>
        {% elif profit < 0 %}<i class="bi bi-graph-down-arrow me-1"></i>
        {% endif %}
      {% endif %}
      {% if profit > 0 and show_sign %}+{% endif %}{{ profit|intcomma_float:decimal_places }}円
    </span>
  {% endif %}
{% endif %}

{% if percent is not None %}
  <span class="price-change {% if percent > 0 %}positive text-success{% elif percent < 0 %}negative text-danger{% endif %} {% if size %}change-{{ size }}{% endif %}">
    ({% if percent > 0 and show_sign %}+{% endif %}{{ percent|floatformat:2 }}%)
  </span>
{% endif %}

{% endwith %}
